webpackJsonp([4],{"59hW":function(s,t){},"5BNv":function(s,t){},J3as:function(s,t){},QjFE:function(s,t){},WMEK:function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("lC5x"),n=e.n(a),i=e("J0Oq"),r=e.n(i),c={props:{isShowReply:{type:Boolean,default:!1},zone:{type:String,default:"blog"},remarkId:String},data:function(){return{content:"",guestInfo:{nickname:"",email:"",website:""},author:""}},created:function(){var s=localStorage.getItem("userinfo");s&&(s=JSON.parse(s),this.author=s._id)},methods:{cancleReply:function(){this.$parent.cancleReply&&this.$parent.cancleReply()},goPublish:function(){var s=this;return r()(n.a.mark(function t(){var e;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,s.content){t.next=6;break}return s.$message({type:"error",message:"请填写内容"}),t.abrupt("return");case 6:if(s.author||s.guestInfo.nickname){t.next=11;break}return s.$message({type:"error",message:"请填写昵称"}),t.abrupt("return");case 11:if(s.author||e.test(s.guestInfo.email)){t.next=14;break}return s.$message({type:"error",message:"请填写正确邮箱"}),t.abrupt("return");case 14:if(!s.isShowReply){t.next=20;break}return t.next=17,s.$axios.post("/reply/add",{content:s.content,guestInfo:s.guestInfo,zone:s.zone,remarkId:s.remarkId,author:s.author});case 17:return 1==t.sent.data.code&&s.$message({type:"success",message:"评论成功"}),t.abrupt("return");case 20:return t.next=22,s.$axios.post("/remark/add",{content:s.content,guestInfo:s.guestInfo,zone:s.zone,author:s.author});case 22:1==t.sent.data.code&&s.$message({type:"success",message:"评论成功"});case 24:case"end":return t.stop()}},t,s)}))()}}},o={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"discuss-content-con"},[e("div",{staticClass:"tip"},[e("span",{staticClass:"el-icon-notebook-1"}),s._v("发表评论"),e("i",{directives:[{name:"show",rawName:"v-show",value:s.isShowReply,expression:"isShowReply"}],staticClass:"cancle",on:{click:s.cancleReply}},[s._v("取消回复")])]),s._v(" "),e("div",{staticClass:"user-temp"},[e("el-input",{staticClass:"user-temp-item",attrs:{placeholder:"昵称"},model:{value:s.guestInfo.nickname,callback:function(t){s.$set(s.guestInfo,"nickname",t)},expression:"guestInfo.nickname"}}),s._v(" "),e("el-input",{staticClass:"user-temp-item",attrs:{placeholder:"邮箱"},model:{value:s.guestInfo.email,callback:function(t){s.$set(s.guestInfo,"email",t)},expression:"guestInfo.email"}}),s._v(" "),e("el-input",{staticClass:"user-temp-item",attrs:{placeholder:"网址"},model:{value:s.guestInfo.website,callback:function(t){s.$set(s.guestInfo,"website",t)},expression:"guestInfo.website"}})],1),s._v(" "),e("div",{staticClass:"discuss-content"},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"写点什么..."},model:{value:s.content,callback:function(t){s.content=t},expression:"content"}})],1),s._v(" "),e("div",{staticClass:"disucss-publish"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:s.goPublish}},[s._v("提交")])],1)])},staticRenderFns:[]};var u=e("C7Lr")(c,o,!1,function(s){e("QjFE")},"data-v-99f5eb14",null).exports,l={components:{"discuss-publish":u},props:{discussItem:Object,zone:{type:String,default:"blog"},remarkId:String,inner:{type:Boolean,default:!1}},filters:{getTime:function(s){return(s=new Date(s)).getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()+" "+s.getHours()+":"+s.getMinutes()}},computed:{getName:function(){return this.discussItem.author?Array.isArray(this.discussItem.author)?this.discussItem.author[0]:this.discussItem.author:""}},data:function(){return{replyFlag:!1}},methods:{cancleReply:function(){this.replyFlag=!1},goUrl:function(s){s?window.open(s):this.$message({type:"info",message:"没有互访页面"})}}},d={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"discuss-item"},[e("div",{staticClass:"discuss-list-title"},[e("div",{staticClass:"main-discuss-item"},[e("div",{staticClass:"left"},[e("img",{directives:[{name:"show",rawName:"v-show",value:!s.inner,expression:"!inner"}],attrs:{src:"http://img.baozinews.cn/blog/static/nav_four.jpg",alt:""}})]),s._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"top"},[s.getName?e("div",{staticClass:"avatarinfo"},[e("img",{directives:[{name:"show",rawName:"v-show",value:s.inner,expression:"inner"}],staticClass:"avatar-img",attrs:{src:"http://img.baozinews.cn/blog/static/nav_four.jpg",alt:""}}),s._v(" "),e("span",{staticClass:"avatar",on:{click:function(t){return s.goUrl(s.discussItem.guestInfo.website)}}},[s._v(s._s(s.getName.username))]),s._v(" "),"admin"!==s.getName.username?e("span",{staticClass:"tag vip"},[s._v("用户")]):e("span",{staticClass:"tag super"},[s._v("博主")])]):e("div",{staticClass:"avatarinfo"},[e("img",{directives:[{name:"show",rawName:"v-show",value:s.inner,expression:"inner"}],staticClass:"avatar-img",attrs:{src:"http://img.baozinews.cn/blog/static/nav_four.jpg",alt:""}}),s._v(" "),e("span",{staticClass:"avatar",on:{click:function(t){return s.goUrl(s.discussItem.guestInfo.website)}}},[s._v(s._s(s.discussItem.guestInfo.nickname))]),s._v(" "),e("span",{staticClass:"tag"},[s._v("游客")])]),s._v(" "),e("div",{staticClass:"time"},[s._v(s._s(s._f("getTime")(s.discussItem.createAt)))])]),s._v(" "),e("div",{staticClass:"content"},[s._v("\n                    "+s._s(s.discussItem.content)+"\n                ")]),s._v(" "),e("div",{staticClass:"bottom"},[e("div",{staticClass:"reply",on:{click:function(t){s.replyFlag=!0}}},[s._v("回复")])]),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:s.replyFlag,expression:"replyFlag"}],staticClass:"inner-publish"},[e("discuss-publish",{attrs:{remarkId:s.remarkId,zone:s.zone,isShowReply:!0}})],1)])])])])},staticRenderFns:[]};var v={components:{"discuss-publish":u,"discuss-item":e("C7Lr")(l,d,!1,function(s){e("59hW")},"data-v-487932c6",null).exports},props:{zone:{type:String,default:"blog"}},data:function(){return{replyFlag:!1,discussInfo:{},pageNum:1}},created:function(){this.init()},methods:{init:function(){var s=this;return r()(n.a.mark(function t(){var e;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.$axios.get("/remark/list",{params:{zone:s.zone,pageNum:s.pageNum}});case 2:1==(e=t.sent).data.code&&(s.discussInfo=e.data.data);case 5:case"end":return t.stop()}},t,s)}))()}}},p={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"discuss-inner"},[e("discuss-publish",{attrs:{zone:s.zone}}),s._v(" "),0!=s.discussInfo.count?e("div",{staticClass:"discuss-list-title"},[e("div",{staticClass:"top"},[s._m(0),s._v(" "),e("div",{staticClass:"tip"},[s._v("\n                (有"),e("span",[s._v(s._s(s.discussInfo.count))]),s._v("条评论)\n            ")])]),s._v(" "),e("div",{staticClass:"new-discuss"},[s._v("最新评论")]),s._v(" "),s._l(s.discussInfo.list,function(t){return e("div",{key:t._id,staticClass:"out"},[e("discuss-item",{attrs:{zone:s.zone,remarkId:t._id,discussItem:t}}),s._v(" "),s._l(t.replys,function(a){return e("div",{key:a._id,staticClass:"inner"},[e("discuss-item",{attrs:{zone:s.zone,remarkId:t._id,inner:!0,discussItem:a}})],1)})],2)})],2):e("div",{staticClass:"null"},[s._v("暂无评论")])],1)},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"text"},[t("span",{staticClass:"el-icon-edit"}),this._v("评论列表")])}]};var m={components:{"v-discuss":e("C7Lr")(v,p,!1,function(s){e("J3as")},"data-v-59213248",null).exports}},f={render:function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"disucss"},[t("v-discuss",{attrs:{zone:"discuss"}})],1)},staticRenderFns:[]};var g=e("C7Lr")(m,f,!1,function(s){e("5BNv")},"data-v-ee2c17a6",null);t.default=g.exports}});
//# sourceMappingURL=4.8b885b742b4bb598b2fc.js.map